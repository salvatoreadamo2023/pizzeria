<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { background:#f0f2f5; }
        .card-gradient { background: linear-gradient(135deg, #ff7e5f, #feb47b); color:white; border:none; border-radius:1rem; }
        .sidebar { background:#343a40; color:white; min-height:100vh; padding-top:2rem; }
        .sidebar a { color:white; display:block; padding:0.8rem; text-decoration:none; }
        .sidebar a:hover { background:#495057; border-radius:0.5rem; }
    </style>
</head>
<body>
<div class="d-flex">
    <div class="sidebar col-md-2 d-none d-md-block">
        <h4 class="text-center mb-4">üçï Pizzeria</h4>
        <a href="/dashboard">Dashboard</a>
        <a href="/prodotti">Prodotti</a>
        <a href="/comande">Comande</a>
        <a th:href="@{/logout}">Logout</a>
    </div>

    <div class="col-md-10 p-4">
        <h1 class="mb-4">Benvenuto, <span th:text="${#authentication.name}">Utente</span>!</h1>
        <div class="row g-4">
            <div class="col-md-4">
                <div class="card card-gradient p-3">
                    <h6>Comande Oggi</h6>
                    <h3 th:text="${comandeOggi}">0</h3>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card card-gradient p-3">
                    <h6>Incasso</h6>
                    <h3 th:text="${incasso}">0 ‚Ç¨</h3>
                </div>
            </div>
            <div class="col-md-4">
                <div class="card card-gradient p-3">
                    <h6>Totale Prodotti</h6>
                    <h3 th:text="${prodottiTotali}">0</h3>
                </div>
            </div>
        </div>

        <div class="card mt-4 p-3">
            <h5>Andamento settimanale</h5>
            <canvas id="chart"></canvas>
        </div>
    </div>
</div>

<script th:inline="javascript">
    /* Dati dinamici dalla controller */
    const labels = [[${giorniSettimana}]];
    const dataComande = [[${comandeSettimanali}]];

    const ctx = document.getElementById('chart');
    if(ctx){
        new Chart(ctx,{
            type:'line',
            data:{
                labels: labels,
                datasets:[{
                    label:'Comande',
                    data: dataComande,
                    borderColor:'#ff7e5f',
                    backgroundColor:'rgba(255,126,95,0.2)',
                    tension:0.3,
                    fill:true
                }]
            }
        });
    }
</script>
</body>
</html>
